@{
    double totalPrice = 0;
    double totalCant = 0;
}
@model IEnumerable<ArtShop.Entities.Model.CartItem>

<script type="text/javascript">
    jQuery(document).ready(function ($) {
        'use strict';
        jQuery('body').backstretch([
            "/images/Galeria/galeriaArte3.jpg",
            "/images/Galeria/galeriaArte1.jpg",
            "/images/Galeria/galeriaArte2.jpg",
        ], { duration: 5000, fade: 500 });

        $("#mapwrapper").gMap({
            controls: false,
            scrollwheel: false,
            markers: [{
                latitude: 40.7566,
                longitude: -73.9863,
                icon: {
                    image: "images/marker.png",
                    iconsize: [44, 44],
                    iconanchor: [12, 46],
                    infowindowanchor: [12, 0]
                }
            }],
            icon: {
                image: "images/marker.png",
                iconsize: [26, 46],
                iconanchor: [12, 46],
                infowindowanchor: [12, 0]
            },
            latitude: 40.7566,
            longitude: -73.9863,
            zoom: 14
        });
    });
</script>

<link rel="stylesheet" href="~/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="~/css/elegant-icons.css" type="text/css">
<link rel="stylesheet" href="~/css/nice-select.css" type="text/css">
<link rel="stylesheet" href="~/css/jquery-ui.min.css" type="text/css">
<link rel="stylesheet" href="~/css/owl.carousel.min.css" type="text/css">
<link rel="stylesheet" href="~/css/slicknav.min.css" type="text/css">
<link rel="stylesheet" href="~/css/styleCart.css" type="text/css">

<section id="single-page-slider" class="no-margin">
    <div class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
            <div class="item active">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="center gap fade-down section-heading">
                                <h2 class="main-title">ARTSHOP CARRITO DE COMPRAS</h2>
                                <hr>
                                <p>Descubra el mundo en pintura.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!--/.item-->
        </div><!--/.carousel-inner-->
    </div><!--/.carousel-->
</section><!--/#main-slider-->

<div id="content-wrapper">
    <section id="portfolio" class="white">
        <section class="shoping-cart spad">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="shoping__cart__table">
                            <table>
                                <thead>
                                    <tr>
                                        <th class="shoping__product">Producto</th>
                                        <th>Precio</th>
                                        <th>Cantidad</th>
                                        <th>Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>


                                    @foreach (var cartItem in Model)
                                    {
                                        totalPrice += @cartItem.Product.Price * cartItem.Quantity;
                                        totalCant = @cartItem.Product.Price * cartItem.Quantity;
                                        <tr>
                                            <td class="shoping__cart__item">
                                                <img src="~/images/Obras/@cartItem.Product.Image" alt="http://placehold.it/100x100" style="object-fit: contain;height: 100px;width: 100px">
                                                <h5>@cartItem.Product.Title</h5>
                                                <h5><small>@cartItem.Product.Artist.FirstName @cartItem.Product.Artist.LastName </small></h5>
                                            </td>
                                            <td class="shoping__cart__price">
                                                $@cartItem.Product.Price
                                            </td>
                                            <td class="shoping__cart__quantity">
                                                    <div class="quantity">
                                                        <div class="pro-qty">
                                                            <input class="cant" type="text" value=@cartItem.Quantity>
                                                        </div>
                                                    </div>
                                                </td>
                                            <td class="shoping__cart__total">
                                                $@totalCant
                                            </td>
                                            <td class="shoping__cart__item__close">
                                                <button onclick="EliminarItem(@cartItem.Id)" class="icon_close" id="@cartItem.Id"></button>
                                                @*<span class="icon_close" id="@cartItem.ProductId"></span>*@
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        <div class="shoping__cart__btns">
                            <a href="#" class="primary-btn cart-btn" id="btnSeguirComprando">Continuar Comprando</a>
                            @*<a href="#" class="primary-btn cart-btn cart-btn-right">
                                <span class="icon_loading"></span>
                                Actualizar Carrito
                            </a>*@
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="shoping__checkout">
                            <h5>Resumen</h5>
                            <ul>
                                <li>Subtotal <span>$@totalPrice</span></li>
                                <li>Total <span>$@totalPrice</span></li>
                            </ul>
                            <button type="button" class="primary-btn" id="btnComprar">
                                Comprar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </section>
</div>

<script src="~/Scripts/jquery.min.js"></script>

<script>

    $("#btnComprar").click(function () {
        window.location = "/Carrito/Compra";
    });

</script>

<script>
    $("#btnSeguirComprando").click(function () {
        window.location = "/Galeria/Index";
    })
</script>

<script>
    $(".inc qtybtn").click(function () {
        var $button = $(this);
        var oldValue = $button.parent().find('input').val();
            var newVal = parseFloat(oldValue) + 1;
        $button.parent().find('input').val(newVal);
    })
</script>

<script>
    $(".dec qtybtn").click(function () {
        var $button = $(this);
        var oldValue = $button.parent().find('input').val();
            if (oldValue > 0) {
                var newVal = parseFloat(oldValue) - 1;
            }
            else {
                newVal = 0;
            }  
        $button.parent().find('input').val(newVal);
    })
</script>


<script>
    function EliminarItem(id) {
        $.ajax({
            type: "POST",
            url: "/CartItem/Delete/",
            data: {
                'id': id
            },
            success: function (datos) {
                location.reload();
            }
        });
    }
</script>